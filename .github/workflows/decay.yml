name: å®šæ—¶è¡°å‡ (Decay)

on:
  schedule:
    # æ¯ 6 å°æ—¶è¿è¡Œä¸€æ¬¡ï¼ˆUTC æ—¶é—´ï¼‰
    # æ ¼å¼ï¼šåˆ†é’Ÿ å°æ—¶ æ—¥ æœˆ æ˜ŸæœŸ
    - cron: '0 */6 * * *'  # æ¯ 6 å°æ—¶çš„æ•´ç‚¹è¿è¡Œï¼ˆ00:00, 06:00, 12:00, 18:00 UTCï¼‰
  
  # å…è®¸æ‰‹åŠ¨è§¦å‘ï¼ˆç”¨äºæµ‹è¯•ï¼‰
  workflow_dispatch:

jobs:
  decay:
    runs-on: ubuntu-latest
    
    permissions:
      contents: write  # éœ€è¦å†™å…¥æƒé™æ¥æäº¤æ–‡ä»¶
    
    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v4
      
      - name: è®¾ç½® Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: è¿è¡Œè¡°å‡è„šæœ¬
        run: |
          python3 scripts/decay.py
      - name: æ›´æ–° README
        run: |
          python3 scripts/readme_update.py
      
      - name: æäº¤çŠ¶æ€æ›´æ–°
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add data/state.json README.md
          git diff --staged --quiet || git commit -m "ğŸ• å®šæ—¶è¡°å‡ï¼šæ›´æ–° Octavia çŠ¶æ€ [skip ci]"
          git push